min_version: 0.12.0
dependencies:
hooks:
  before:
    - bin/build.sh $TEST_PLATFORMS
actions:
  build:
    command: bin/build.sh $TEST_PLATFORMS
    alias: b
  test:
    command: bin/run.sh "bin/ops test" $TEST_PLATFORMS
    alias: t
  test-watch:
    command: rerun -x "bin/run.sh \"bin/ops test\" $TEST_PLATFORMS"
    alias: tw
  test-e2e:
    command: bin/run.sh "bin/ops test-e2e" $TEST_PLATFORMS
    alias: e2e
  test-e2e-watch:
    command: rerun -x --dir .. "bin/run.sh \"bin/ops test-e2e\" $TEST_PLATFORMS"
    alias: ew
  console:
    command: bin/run.sh bash
    alias: c
  remove-images:
    command: docker image rm `docker image ls -qf "reference=ops-*"`
    alias: rm
options:
  environment:
    TEST_PLATFORMS: ops-*
